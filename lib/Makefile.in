# $Id: Makefile.in,v 1.10 2005/04/23 07:42:05 smoli Exp $
# ===========================================================================
#
# GNU Makefile for libshish
#
# relative directories
# ---------------------------------------------------------------------------
srcdir       = @srcdir@
top_srcdir   = @top_srcdir@
builddir     = @builddir@
top_builddir = @top_builddir@
thisdir      = lib/

# include config.mk (makefile config)
# ---------------------------------------------------------------------------
include $(top_builddir)/config.mk

#############################################################################
#                                    ########################################
#  ROOT & RECURSIVE CONFIGURATION    ########################################
#                                    ########################################
#############################################################################

# redirect to recursive targets
# ---------------------------------------------------------------------------
all:              makefiles all-recursive 
clean:            makefiles clean-recursive
distclean:        makefiles distclean-recursive
maintainer-clean: makefiles maintainer-clean-recursive
install:          makefiles install-recursive
dep:              makefiles dep-recursive 

RM    = rm -f
CHMOD = chmod

# directory configuration
# ---------------------------------------------------------------------------
SUBDIRS              = buffer byte fmt mmap open scan shell str stralloc uint32 
ROOT                 = 0
RECURSIVE            = 1

LIBRARY = libshish.a

CLEANFILES = $(LIBRARY)

#############################################################################
#                                    ########################################
#  LOCAL DIRECTORY CONFIGURATION     ########################################
#                                    ########################################
#############################################################################
#MODULES += mingw-glob
MODULES += buffer/buffer_close buffer/buffer_default buffer/buffer_dummyread buffer/buffer_dummyreadmmap buffer/buffer_dump buffer/buffer_feed buffer/buffer_flush buffer/buffer_free buffer/buffer_fromsa buffer/buffer_fromstr buffer/buffer_get buffer/buffer_get_until buffer/buffer_getc buffer/buffer_init buffer/buffer_mmapprivate buffer/buffer_mmapread buffer/buffer_mmapread_fd buffer/buffer_prefetch buffer/buffer_put buffer/buffer_putc buffer/buffer_putflush buffer/buffer_putm_internal buffer/buffer_putnlflush buffer/buffer_putnspace buffer/buffer_puts buffer/buffer_putsa buffer/buffer_putsflush buffer/buffer_putspace buffer/buffer_putulong buffer/buffer_skip_until buffer/buffer_stubborn buffer/buffer_stubborn2 buffer/buffer_tosa buffer/buffer_truncfile byte/byte_chr byte/byte_copy byte/byte_copyr byte/byte_diff byte/byte_fill byte/byte_rchr byte/byte_zero fmt/fmt_long fmt/fmt_minus fmt/fmt_ulong fmt/fmt_ulong0 fmt/fmt_xlong fmt/fmt_xlonglong mmap/mmap_private mmap/mmap_read mmap/mmap_read_fd open/open_read open/open_temp open/open_trunc scan/scan_8long scan/scan_int scan/scan_long scan/scan_uint scan/scan_ulong shell/shell_alloc shell/shell_basename shell/shell_dirname shell/shell_error

OBJECTS = $(MODULES:%=%.o)
SOURCES = $(MODULES:%=%.c)
HEADERS = $(MODULES:%=%.h)
DEPS = $(MODULES:%=%.d)

HEADERS += buffer.h byte.h fmt.h mmap.h open.h safemult.h scan.h shell.h str.h stralloc.h uint16.h uint32.h uint64.h
 

-include $(DEPS)

# targets           build.mk config.h $(srcdir)/configure 
# ---------------------------------------------------------------------------
all-local:  $(OBJECTS) $(LIBRARY) 
install-local: install-data install-exec
dep-local:

@DEPS_TRUE@$(LIBRARY): $(SUBDIRS:%=%/.libdep) 
-$(LIBRARY): $(OBJECTS)
	@$(ECHO_AR)
	@SILENT_RULES@$(AR) $(ARFLAGS) $(LIBRARY) $(OBJECTS)
	@$(ECHO_RANLIB)
	@SILENT_RULES@$(RANLIB) $(LIBRARY)

# files that go into distribution tarballs
# ---------------------------------------------------------------------------
FILES                = Makefile.in $(HEADERS) 
                       
# files to be cleaned
# ---------------------------------------------------------------------------
CLEANFILES           = *~ core core.* 
DISTCLEANFILES       = Makefile $(DEPS)
MAINTAINERCLEANFILES = shish shish-$(VERSION)

# include global make targets
# ---------------------------------------------------------------------------
include $(top_builddir)/build.mk
